$(document).ready(function() {
    // Function to handle form submission and AJAX request
    function handleFormSubmit(formId, ajaxUrl, successCallback, failCallback) {
        $(formId).submit(function(e) {
            e.preventDefault(); // Prevent default form submission
            
            // Get form data
            var formData = $(this).serialize();
            
            // Perform AJAX request
            $.ajax({
                type: 'POST',
                url: ajaxUrl,
                data: formData,
                success: function(response, status, xhr) {
                    // Call the success callback function with response and status
                    successCallback(response, status, xhr);
                },
                error: function(xhr, status, error) {
                    // Log AJAX request error to the console
                    console.error('Erreur de requête AJAX:', error);
                    if (failCallback) {
                        failCallback(xhr, status, error);
                    }
                }
            });
        });
    }



// Optional fail callback
function loginFail(xhr, status, error) {
    // Handle login error
    console.log('Erreur de connexion:', xhr.responseText);
    $('#passwordError').show();
}

// Success callback functions
    function loginSuccess(response) {
        console.log('Connexion réussie!');
        window.location.href = '/';

    }

    function addCharacterSuccess(response) {
        if (response.message) {
            console.log('Character added successfully with ID:', response.id);
            window.location.href = '/personnages/' + response.message;
        } else {
            console.log('Error: Character ID not found in the response');
        }
        console.log('Réponse du serveur:', response);
    }

    function updateCaracSetSuccess(response) {
        console.log('Caracteristique set updated.!');
        console.log(response);
    }

    function deleteCharacterSuccess(response, status, xhr) {
        console.log('Character deleted successfully!');
        window.location.href = '/personnages';
        console.log('Réponse du serveur:', response);
    }

    // Attach handlers to forms
    handleFormSubmit('#loginForm', '/log/login', loginSuccess, loginFail);
    handleFormSubmit('#addCharacterForm', '/personnages/addCharacter', addCharacterSuccess);
    handleFormSubmit('#characSetForm', '/personnages/updateCaracSet', updateCaracSetSuccess);
    handleFormSubmit('#deleteCharacterForm', '/personnages/deleteCharacter', deleteCharacterSuccess);
});